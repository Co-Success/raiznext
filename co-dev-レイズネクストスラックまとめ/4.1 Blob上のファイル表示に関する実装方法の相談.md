日山しずか（Sol G）日山しずか（Sol G）  [4月1日 13:59](https://sensyn-robotics.slack.com/archives/C06MR75MQKY/p1743483547693099)  

[@菅原 泰樹 (テクG)](https://sensyn-robotics.slack.com/team/U03MKLCJWN6) [@岡村 智史 (Dev, Platform App)](https://sensyn-robotics.slack.com/team/U88UW2EFM) [@野田 智也](https://sensyn-robotics.slack.com/team/U07MMEVHBD3) [@和田 剛 (plant dev)](https://sensyn-robotics.slack.com/team/U07D1SN9CJ1) [@倉谷伸宏](https://sensyn-robotics.slack.com/team/U07LW7F5ABA)  
急ですみませんが、本日14時半～時間が合いそうなので、  
[https://sensyn-robotics.atlassian.net/browse/WD-1502](https://sensyn-robotics.atlassian.net/browse/WD-1502)  
について、Blob上のファイル表示に関する実装方法の相談をさせてください![:おじぎ_女性:](https://a.slack-edge.com/production-standard-emoji-assets/14.0/apple-medium/1f647-200d-2640-fe0f.png)概要：  

- 現状、溶接アプリでは、Blob上の画像データの直URLが、どこからでもアクセス可能な状態になっている（非ログイン状態でもURLさえわかれば3時間以内ならアクセスができる）
- 昨日藤田さんに相談したところ、Datastoreなどではなんらか回避しているはず？とのこと
- 最適な実装方法についてのご相談と、対応する場合の工数感などを相談したい

**[WD-1502 【Web】WPSファイルのリンクが未ログイン状態のブラウザでもアクセス（ダウンロード）できてしまう](https://sensyn-robotics.atlassian.net/browse/WD-1502?atlOrigin=eyJpIjoiZTZjMTZmYTJjYmQxNDVjZmFmYzAyM2U3ODk0MGU2MjEiLCJwIjoiamlyYS1zbGFjay1pbnQifQ)**

Status: **98_完了**

Type: **バグ**

Assignee: **河口真貴子**

Priority: **Medium**

Assign

Change status

Comment

投稿したメンバー: [Jira Cloud](https://sensyn-robotics.slack.com/services/B01E57FFHGU "Jira Cloud")

![:okマーク:](https://a.slack-edge.com/production-standard-emoji-assets/14.0/apple-small/1f197.png)2

19 件の返信

---

![](https://ca.slack-edge.com/T7L88TM38-U88UW2EFM-08aef220581b-48)

岡村 智史 (Dev, Platform App)岡村 智史 (Dev, Platform App)![:庭付き家:](https://a.slack-edge.com/production-standard-emoji-assets/14.0/apple-large/1f3e1.png)  [4月1日 14:07](https://sensyn-robotics.slack.com/archives/C06MR75MQKY/p1743484022931019?thread_ts=1743483547.693099&cid=C06MR75MQKY)  

> Datastoreなどではなんらか回避しているはず？とのこと

特に何もしてないです。SASによる有効期限設定だけ。

![:naruhodo:](https://emoji.slack-edge.com/T7L88TM38/naruhodo/0a9968f4dcce9990.png)1

[14:07](https://sensyn-robotics.slack.com/archives/C06MR75MQKY/p1743484075409919?thread_ts=1743483547.693099&cid=C06MR75MQKY)

これのことですよね  
[https://sensyn-robotics.slack.com/archives/C01A0C1LZBL/p1742958416650419](https://sensyn-robotics.slack.com/archives/C01A0C1LZBL/p1742958416650419)

![](https://ca.slack-edge.com/T7L88TM38-U07MMEVHBD3-ebba4d0379b2-24)**野田 智也**

[@中山 淳 (Sol G (Dev))](https://sensyn-robotics.slack.com/team/U9YT2GF6C) [@佐々木 義広(Ent/Str電力/基盤Dev) 6/13(金)休み](https://sensyn-robotics.slack.com/team/U035M8PDXPA) [@菅原 泰樹 (テクG)](https://sensyn-robotics.slack.com/team/U03MKLCJWN6) [@岡村 智史 (Dev, Platform App)](https://sensyn-robotics.slack.com/team/U88UW2EFM)  
ちょっとご意見を伺いたいです。  
各システムのファイルデータのアップロード、ダウンロードについてです。ファイルの配置先を Azure Blog Storage を使って、SASという認証情報をクエリストリングを付けて一時的なアクセスを可能とする仕組みを色んなプロダクトで入れていると思います。

もっと表示する

プライベートの会話から

 | 3月26日

![:+1:](https://a.slack-edge.com/production-standard-emoji-assets/14.0/apple-small/1f44d.png)1![:おじぎ_女性:](https://a.slack-edge.com/production-standard-emoji-assets/14.0/apple-small/1f647-200d-2640-fe0f.png)1

![](https://ca.slack-edge.com/T7L88TM38-U07D1SN9CJ1-57617275cd14-48)

和田 剛 (plant dev)和田 剛 (plant dev)  [4月1日 14:10](https://sensyn-robotics.slack.com/archives/C06MR75MQKY/p1743484224813069?thread_ts=1743483547.693099&cid=C06MR75MQKY)  

リンククリックするたびに新しい認証情報つきURLを発行するように改修して、有効期限を分単位にするのが良いと思います。  
DataStoreはSSRなのでそれができないが、WEL-ONEは特に問題なしと認識してます。 （編集済み） 

![](https://ca.slack-edge.com/T7L88TM38-U03RE33C3A5-965cb9873a75-48)

藤田 大介（CORE-G PF）藤田 大介（CORE-G PF）  [4月1日 14:28](https://sensyn-robotics.slack.com/archives/C06MR75MQKY/p1743485286958649?thread_ts=1743483547.693099&cid=C06MR75MQKY)  

> Datastore

部分的な情報での発信だったのかもしれないですが、そのURLに直接触れられる場所がない、という意味で対応していると話をしました（＝サービスのログインの認証でカバーされる）。チケットや情報見るにちょっとニュアンスが違っていたかもです。 （編集済み） 

![:おじぎ_女性:](https://a.slack-edge.com/production-standard-emoji-assets/14.0/apple-small/1f647-200d-2640-fe0f.png)1

![](https://ca.slack-edge.com/T7L88TM38-U88UW2EFM-08aef220581b-48)

岡村 智史 (Dev, Platform App)岡村 智史 (Dev, Platform App)![:庭付き家:](https://a.slack-edge.com/production-standard-emoji-assets/14.0/apple-large/1f3e1.png)  [4月1日 14:29](https://sensyn-robotics.slack.com/archives/C06MR75MQKY/p1743485398789349?thread_ts=1743483547.693099&cid=C06MR75MQKY)  

> ＝サービスのログインの認証でカバーされる

SASには認証情報ないのでSENSYN COREログインしてなくてもURL知ってたらアクセスできます

![](https://ca.slack-edge.com/T7L88TM38-U07LW7F5ABA-9f1d1b6aa52f-48)

倉谷伸宏倉谷伸宏  [4月1日 14:53](https://sensyn-robotics.slack.com/archives/C06MR75MQKY/p1743486796432119?thread_ts=1743483547.693099&cid=C06MR75MQKY)  

[https://msrc.microsoft.com/blog/2023/09/microsoft-mitigated-exposure-of-internal-infor[…]in-a-storage-account-due-to-overly-permissive-sas-token-ja/](https://msrc.microsoft.com/blog/2023/09/microsoft-mitigated-exposure-of-internal-information-in-a-storage-account-due-to-overly-permissive-sas-token-ja/)  
MSのベストプラクティス  

- **存続期間の短い SAS の使用**: SAS を作成するときは常に有効期限が近い時間を使用し、必要に応じてクライアントに新しい SAS URL を要求してもらいます。Azure Storage は、すべての SAS URL に対して 1 時間以下を推奨します。

![:oh-:](https://emoji.slack-edge.com/T7L88TM38/oh-/8028ac3af36bc06e.png)1![:+1:](https://a.slack-edge.com/production-standard-emoji-assets/14.0/apple-small/1f44d.png)1

![](https://ca.slack-edge.com/T7L88TM38-U0405EVJQSZ-000962c57304-48)

日山しずか（Sol G）日山しずか（Sol G）  [4月1日 14:54](https://sensyn-robotics.slack.com/archives/C06MR75MQKY/p1743486847370579?thread_ts=1743483547.693099&cid=C06MR75MQKY)  

**▼この方針で進めたい。できればV2.1（4/28-30リリース）に入れ込みたい**  

- 画面上に直接表示するSASは有効期限を短く(1分とかに)しておく。
- クリックすると読み込まれるようなものは、アクセスすると新規に発行したSASにリダイレクトするようにしておく。こちらも有効期限は短くする。

→読み込みのラグ等踏まえて30秒くらいでもいいかも**▼開発ボリューム**  

- 5人日未満くらいで実装可能＋1日QA（仮）？
- 内容：フロントの改修3か所、API Endpointつくる
- ~~4/23~~4/16までに実装できればOKか？河口さんに相談

**▼参考情報**  

- 帳票出力の仕組みが一部使えそう
- V1で、WEL-ONEからパスを渡すと返してくれる仕組みがあった。それがつかえそう
- （上記で実装する場合）今後無限スクロールが工事詳細などのサムネ画像有画面に導入されると、仕組み考えないとかも
    - V2では全表示なので気にしなくてOK
- 別案）
    - Blob→WEL-ONEのIP経由で→WEL-ONEアプリが画像をDL→クライアントに渡す ようにする
        - 今回は採択しない

（編集済み）

[14:57](https://sensyn-robotics.slack.com/archives/C06MR75MQKY/p1743487026591929?thread_ts=1743483547.693099&cid=C06MR75MQKY)

[@倉谷伸宏](https://sensyn-robotics.slack.com/team/U07LW7F5ABA)  
上記の件、Jiraチケット作りたいのですが、v2.1.0 STG環境バグのエピックでいいですかね？

![:arigatougozaimasu:](https://emoji.slack-edge.com/T7L88TM38/arigatougozaimasu/25534294bfcd5e8e.png)1![:yes:](https://emoji.slack-edge.com/T7L88TM38/yes/811680dad77e255b.png)1

![](https://ca.slack-edge.com/T7L88TM38-U0405EVJQSZ-000962c57304-48)

日山しずか（Sol G）日山しずか（Sol G）  [4月1日 15:13](https://sensyn-robotics.slack.com/archives/C06MR75MQKY/p1743487995059289?thread_ts=1743483547.693099&cid=C06MR75MQKY)  

[@和田 剛 (plant dev)](https://sensyn-robotics.slack.com/team/U07D1SN9CJ1) [@野田 智也](https://sensyn-robotics.slack.com/team/U07MMEVHBD3)  
そういえば、この件って、Nativeも関係しますか・・？

![](https://ca.slack-edge.com/T7L88TM38-U07D1SN9CJ1-57617275cd14-48)

和田 剛 (plant dev)和田 剛 (plant dev)  [4月1日 15:13](https://sensyn-robotics.slack.com/archives/C06MR75MQKY/p1743488016171189?thread_ts=1743483547.693099&cid=C06MR75MQKY)  

します。  
FYI [@中山 一哉（SR）](https://sensyn-robotics.slack.com/team/U07PWRT53FF)

![](https://ca.slack-edge.com/T7L88TM38-U0405EVJQSZ-000962c57304-48)

日山しずか（Sol G）日山しずか（Sol G）  [4月1日 15:14](https://sensyn-robotics.slack.com/archives/C06MR75MQKY/p1743488044171619?thread_ts=1743483547.693099&cid=C06MR75MQKY)  

共通の実装で、Nativeにも適用可能なものでしょうか？

![](https://ca.slack-edge.com/T7L88TM38-U07D1SN9CJ1-57617275cd14-48)

和田 剛 (plant dev)和田 剛 (plant dev)  [4月1日 15:14](https://sensyn-robotics.slack.com/archives/C06MR75MQKY/p1743488050953619?thread_ts=1743483547.693099&cid=C06MR75MQKY)  

([@中山 一哉（SR）](https://sensyn-robotics.slack.com/team/U07PWRT53FF)多分既存のSAS取得APIが使えるはずです)

![:両目:](https://a.slack-edge.com/production-standard-emoji-assets/14.0/apple-small/1f440.png)1

[15:14](https://sensyn-robotics.slack.com/archives/C06MR75MQKY/p1743488095221989?thread_ts=1743483547.693099&cid=C06MR75MQKY)

APIの外側(修正の必要があれば)と画面は個別に実装する必要がありますが、ある程度使えます。 （編集済み） 

![:arigatougozaima:](https://emoji.slack-edge.com/T7L88TM38/arigatougozaima/9aeab1d64822f24f.png)1

![](https://ca.slack-edge.com/T7L88TM38-U0405EVJQSZ-000962c57304-48)

日山しずか（Sol G）日山しずか（Sol G）  [4月1日 15:19](https://sensyn-robotics.slack.com/archives/C06MR75MQKY/p1743488385832809?thread_ts=1743483547.693099&cid=C06MR75MQKY)  

[@和田 剛 (plant dev)](https://sensyn-robotics.slack.com/team/U07D1SN9CJ1)  
ありがとうございます！開発定例等で中山さんにインプット＆4/14-16めどで開発可能か相談をお願いしたいです![:おじぎ_女性:](https://a.slack-edge.com/production-standard-emoji-assets/14.0/apple-medium/1f647-200d-2640-fe0f.png)  
（期限は河口さん相談のうえ変更の可能性はあり）  
Native側もチケット別で起票したほうがいいですよね？  
※Webは起票済み：[https://sensyn-robotics.atlassian.net/browse/WD-1610](https://sensyn-robotics.atlassian.net/browse/WD-1610)

**[WD-1610 【Web】Blob上の画像を表示するためのSAS有効期限の短縮](https://sensyn-robotics.atlassian.net/browse/WD-1610?atlOrigin=eyJpIjoiMjMyOTQxOGVjNmMxNGYwNmE3OGFlYzNlYWUyNGU5NzQiLCJwIjoiamlyYS1zbGFjay1pbnQifQ)**

Status: **TODO**

Type: **バグ**

Assignee: **Unassigned**

Priority: **Medium**

Assign

Change status

Comment

投稿したメンバー: [Jira Cloud](https://sensyn-robotics.slack.com/services/B01E57FFHGU "Jira Cloud")

![:+1:](https://a.slack-edge.com/production-standard-emoji-assets/14.0/apple-small/1f44d.png)1![:onegaisimasu:](https://emoji.slack-edge.com/T7L88TM38/onegaisimasu/64fc06eb804dedb3.png)1

![](https://ca.slack-edge.com/T7L88TM38-U0405EVJQSZ-000962c57304-48)

日山しずか（Sol G）日山しずか（Sol G）  [4月1日 15:25](https://sensyn-robotics.slack.com/archives/C06MR75MQKY/p1743488704890839?thread_ts=1743483547.693099&cid=C06MR75MQKY)  

Done!  
[https://sensyn-robotics.atlassian.net/browse/WD-1611](https://sensyn-robotics.atlassian.net/browse/WD-1611)

**[WD-1611 【Native】Blob上の画像を表示するためのSAS有効期限の短縮](https://sensyn-robotics.atlassian.net/browse/WD-1611?atlOrigin=eyJpIjoiYTdkODBhNzY1N2E0NDhlOTgzOTc4NzRjNDg2MWQ4OTIiLCJwIjoiamlyYS1zbGFjay1pbnQifQ)**

Status: **TODO**

Type: **バグ**

Assignee: **Unassigned**

Priority: **Medium**

Assign

Change status

Comment

投稿したメンバー: [Jira Cloud](https://sensyn-robotics.slack.com/services/B01E57FFHGU "Jira Cloud")

![:arigatougozaima:](https://emoji.slack-edge.com/T7L88TM38/arigatougozaima/9aeab1d64822f24f.png)2

![](https://ca.slack-edge.com/T7L88TM38-U0405EVJQSZ-000962c57304-48)

日山しずか（Sol G）日山しずか（Sol G）  [4月2日 14:52](https://sensyn-robotics.slack.com/archives/C06MR75MQKY/p1743573171608859?thread_ts=1743483547.693099&cid=C06MR75MQKY)  

[@河口 真貴子](https://sensyn-robotics.slack.com/team/U031FRESR55)  
今朝軽く話して、話しきれなかった件、上記です！[WD-1610](https://sensyn-robotics.atlassian.net/browse/WD-1610)  
[WD-1611](https://sensyn-robotics.atlassian.net/browse/WD-1611)こちらについて、開発完了希望日（QA着手希望日）をご確認いただきたいです![:おじぎ_女性:](https://a.slack-edge.com/production-standard-emoji-assets/14.0/apple-medium/1f647-200d-2640-fe0f.png)

**[WD-1610 【Web】Blob上の画像を表示するためのSAS有効期限の短縮](https://sensyn-robotics.atlassian.net/browse/WD-1610?atlOrigin=eyJpIjoiZTA1M2ViODIzOTdhNGFiNDkyNjQ4NWJlZGI0Mzc2MzEiLCJwIjoiamlyYS1zbGFjay1pbnQifQ)**

Status: **TODO**

Type: **バグ**

Assignee: **Unassigned**

Priority: **Medium**

Assign

Change status

Comment

投稿したメンバー: [Jira Cloud](https://sensyn-robotics.slack.com/services/B01E57FFHGU "Jira Cloud")

**[WD-1611 【Native】Blob上の画像を表示するためのSAS有効期限の短縮](https://sensyn-robotics.atlassian.net/browse/WD-1611?atlOrigin=eyJpIjoiYTBhNDE2ZThiZWM0NGNlZjk2MWMxN2M3NTIxMzI3ZGYiLCJwIjoiamlyYS1zbGFjay1pbnQifQ)**

Status: **TODO**

Type: **バグ**

Assignee: **Unassigned**

Priority: **Medium**

Assign

Change status

Comment

投稿したメンバー: [Jira Cloud](https://sensyn-robotics.slack.com/services/B01E57FFHGU "Jira Cloud")

![:両目:](https://a.slack-edge.com/production-standard-emoji-assets/14.0/apple-small/1f440.png)1

![](https://ca.slack-edge.com/T7L88TM38-U031FRESR55-997870642417-48)

河口 真貴子河口 真貴子  [4月2日 15:00](https://sensyn-robotics.slack.com/archives/C06MR75MQKY/p1743573649905869?thread_ts=1743483547.693099&cid=C06MR75MQKY)  

[@日山しずか（Sol G）](https://sensyn-robotics.slack.com/team/U0405EVJQSZ)  
テスト着手4/16でお願いします（デグレなど含めそこは遅延なしのほうこうで）

![](https://ca.slack-edge.com/T7L88TM38-U0405EVJQSZ-000962c57304-48)

日山しずか（Sol G）日山しずか（Sol G）  [4月2日 15:04](https://sensyn-robotics.slack.com/archives/C06MR75MQKY/p1743573879273839?thread_ts=1743483547.693099&cid=C06MR75MQKY)  

ありがとうございます！[@和田 剛 (plant dev)](https://sensyn-robotics.slack.com/team/U07D1SN9CJ1) [@中山 一哉（SR）](https://sensyn-robotics.slack.com/team/U07PWRT53FF)  
開発期限を4/15にさせていただきました![:おじぎ_女性:](https://a.slack-edge.com/production-standard-emoji-assets/14.0/apple-medium/1f647-200d-2640-fe0f.png)  
4/16のAM中にはStgテスト着手可能な状態にしていただけますでしょうか？![:おじぎ_女性:](https://a.slack-edge.com/production-standard-emoji-assets/14.0/apple-medium/1f647-200d-2640-fe0f.png)そこに入れ込めない場合、2.1.1等、後追いリリースも検討します。

![:+1:](https://a.slack-edge.com/production-standard-emoji-assets/14.0/apple-small/1f44d.png)1

![](https://ca.slack-edge.com/T7L88TM38-U07D1SN9CJ1-57617275cd14-48)

和田 剛 (plant dev)和田 剛 (plant dev)  [4月2日 15:13](https://sensyn-robotics.slack.com/archives/C06MR75MQKY/p1743574384294049?thread_ts=1743483547.693099&cid=C06MR75MQKY)  

FYI [@野田 智也](https://sensyn-robotics.slack.com/team/U07MMEVHBD3)